Deriving ISO level wind and solar shapes from grid_cell level shapes
--------------------------------------------------------------------

we use ISO-level shapes in single region models as we model single elc_sol/win-ISO commodities (that carry the shape information)

This shape should represent the "national average" solar/wind shape.

wtd avg shape of the entire supply curve is not a good idea as the potential may far exceed the electricity demand. So, we will get the total base year (2022) generation 
from EMBER and collect as many grid cells (REZoning files have generation by grid_cell information) for solar as are needed to meet the demand, and compute the hourly 
wtd avg capacity factor from the atlite data.
Same approach for wind. So, to confirm, we will assume that the entire base year generation would be generated by solar alone or wind alone - just to select the cells for the wtd avg computation.
of course, we will take as many as available if the demand is more than the solar/wind potential.

Atlite file with hourly capacity factors by grid_cell:
C:\Veda\VerveStacks\data\hourly_profiles\atlite_grid_cell_2013.csv

Solar files:
C:\Veda\VerveStacks\data\REZoning\REZoning_Solar.csv
Step 1: add a new col cf_atlite to this CSV - left JOIN the atlite file that has only 10 ISOs right now. keep the capacity factor col for grid_cell that are missing in atlite data. So, the final
cf info will be in the cf_atlite col.

Step 2: get the 2022 total generation from C:\Veda\VerveStacks\data\ember\yearly_full_release_long_format.csv (Country Code col has the ISO; use variable = 'Total Generation')

Step 3: select all grid cells from REZoning_Solar df (with cf_atlite col). WHERE capacity GW * cf_atlite * 8.76 >= total generation from step 2

Step 4: with the selected grid_cells, compute wtd average capacity_factor for each ISO. capacity factor col by grid_cell in atlite file; use capacity GW * cf_atlite * 8.76 as the weight.

Wind file:
C:\Veda\VerveStacks\data\REZoning\REZoning_WindOnshore
same process as solar.


The final df (we will call it atlite_iso_2013) will have the same structure as atlite_grid_cell_2013.csv, but with iso instead of iso_grid_id. the com_fr_solar and com_fr_wind cols are hourly shares of annual generation.
So, they will be computed as capacity factor/(Sum of capacity factor for all hours).

Output files:
C:\Veda\VerveStacks\data\hourly_profiles\atlite_iso_2013.csv
C:\Veda\VerveStacks\data\REZoning\REZoning_Solar_atlite_cf.csv
C:\Veda\VerveStacks\data\REZoning\REZoning_WindOnshore_atlite_cf.csv